#!/usr/bin/env bash
#MISE description="Stop infrastructure services"
set -euo pipefail

COMPOSE_FILE="metorial-platform/self-hosting/docker-compose.yml"

echo "━━━ Stopping Infrastructure Services ━━━"
echo ""

if [ ! -f "$COMPOSE_FILE" ]; then
    echo "✗ docker-compose.yml not found at: $COMPOSE_FILE"
    exit 1
fi

INFRA_SERVICES="etcd mongodb redis-db meilisearch postgres-db minio opensearch opensearch-dashboards"

echo "→ Stopping: $INFRA_SERVICES"
docker compose -f "$COMPOSE_FILE" stop $INFRA_SERVICES

echo ""
echo "✓ Infrastructure services stopped"
echo ""
echo "Note: Data volumes preserved. Use 'mise run selfhost:reset' to remove all data."